<div class="pratilipi-pratilipi-info">
    <div class="mdl-card mdl-card-border mdl-cell mdl-cell--8-col-tablet mdl-cell--9-col mobile-card">
        <div class="mdl-grid">
            <div class="" style="margin: 8px;background-color: rgba( 0, 0, 0, 0.27 );position: relative;">
	    	    <picture data-bind="visible: !imageUploaded()">
	                <source media="(min-width: 480px)"  data-bind="attr: { srcset: getImageUrl( pratilipi.coverImageUrl(), 200 ) }" />
	                <img data-bind="attr: { src: getImageUrl( pratilipi.coverImageUrl(), 150 ) }" border="0" alt="">
	            </picture> 
				<#-- <img class="pratilipi-cover-image" data-bind="{ attr: { src: getImageUrl( pratilipi.coverImageUrl(), 200 ) },
								visible: !imageUploaded() }" border="0"> -->
				<div data-bind="visible: imageUploaded()" class="image-uploaded-div">
					<div class="spinner-container">
						<span class="image-uploaded-spinner mdl-spinner mdl-spinner--single-color mdl-js-spinner is-active">
						</span>
					</div>
				</div>

                <button class="upload-image-button mdl-button mdl-js-button mdl-button--fab"
                        data-bind="{ click: chooseImageFile,
                                    visible: pratilipi.hasAccessToUpdate() }">
                    <i class="material-icons">camera_alt</i>
                </button>
                <form id="uploadPratilipiImageForm" 
                        style="position: absolute; top: -1000px;"
                        method="post" 
                        enctype="multipart/form-data"
                        data-bind="{ attr: { 'action': '/api/pratilipi/cover?pratilipiId=' + pratilipi.pratilipiId() }, uniqueName: true }" 
                        target="pratilipi_upload_target">
                    <input id="uploadPratilipiImageInput"
                            data-bind="{ event: { change: uploadPratilipiImage }, uniqueName: true }" 
                            type="file" 
                            accept="image/*">
                </form>
                <iframe id="pratilipi_upload_target" 
                        name="pratilipi_upload_target" 
                        style="display: none;"
                        data-bind="event: { load: iframeLoaded }"></iframe>
            </div>
            <div class="mdl-grid mdl-grid--no-spacing pratilipi-info-variable-width" style="flex-grow: 1;margin: 8px;">
                <div class="mdl-cell mdl-cell--12-col mdl-cell--order-1 mdl-cell--order-1-phone">
                    <div class="mdl-card__title padding-bottom-zero padding-top-zero">
                        <h2 class="mdl-card__title-text" data-bind="text: pratilipi.title()"></h2>
                        <button data-bind="visible: pratilipi.hasAccessToUpdate()" 
                            id="pratilipi-info-edit-pratilipi"
                            class="mdl-button mdl-js-button mdl-button--icon">
                        <i class="material-icons">create</i>
                    </button>
                    <ul style="min-width: 200px;" class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="pratilipi-info-edit-pratilipi">
                        <li class="mdl-menu__item" data-toggle="modal" data-target="#pratilipi_edit_pratilipi">${ _strings.pratilipi_edit_info }</li>
                        <li class="mdl-menu__item">
                            <a data-bind="attr: { 'href': pratilipi.writePageUrl() }"
                                style="color: #333; display: block;">
                                ${ _strings.pratilipi_edit_content }
                            </a>
                        </li>
                    </ul>
                    </div>
                    <div class="css-author-name mdl-card__title padding-bottom-zero">
                        <a style="margin: 0; color: #000; font-size: 20px;" data-bind="attr: { href: pratilipi.author.pageUrl() }, text: pratilipi.author.name()"></a>
                    </div>
                    <div class="mdl-card__supporting-text font-16 padding-bottom-zero">
                    	<p class="font-16 margin-bottom-8" data-bind="visible: pratilipi.averageRating() > 0">
	                        <!--ko text: roundOffToOneDecimal( pratilipi.averageRating() ) -->
	                        <!--/ko-->
	                        <i class="material-icons material-icons-16 vertical-middle icon-center">star</i> (
	                        <!--ko text: pratilipi.ratingCount() -->
	                        <!--/ko-->
	                        )
                        </p>
                        <p class="font-16 margin-bottom-8"> ${ _strings.pratilipi_count_reads }:&nbsp;
                            <!--ko text:  formatReadCount( pratilipi.readCount() ) -->
                            <!--/ko-->
                        </p>    
                    </div>
                </div>
                <div class="mdl-cell mdl-cell--12-col mdl-cell--order-3 mdl-cell--order-2-phone">
                    <div class="mdl-card__actions">
                        <a data-bind="{ attr: { href: pratilipi.readPageUrl() }, 
                                        text: pratilipi.state() == 'PUBLISHED' ? '${ _strings.read }' : '${ _strings.writer_preview }' }" 
                            class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored mdl-js-ripple-effect mdl-button-margin"
                        >
                        </a>
                        <button data-bind="{ text: ( userPratilipi.addedToLib() ? '-' : '+' ) + ' ${ _strings.library }', 
                                            click: addToLibrary,
                                            disable: userPratilipiRequestOnFlight,
                                            visible: canAddToLibrary() }" 
                                class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored mdl-js-ripple-effect mdl-button-margin"
               			>
                        </button>
                        <button data-bind="{ visible: pratilipi.hasAccessToUpdate(), 
                                            text: ( pratilipi.state() == 'PUBLISHED' ? '${ _strings.pratilipi_move_to_drafts }' : '${ _strings.pratilipi_publish_it }' ), 
                                            click: togglePratilipiState,
                                            disable: pratilipiRequestOnFlight }" 
                                class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored mdl-js-ripple-effect mdl-button-margin"
                        >
                        </button>
                        <button data-bind="{ visible: canShare() }" class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored mdl-js-ripple-effect share-button" data-toggle="modal" data-target="#pratilipi-share-dialog">
                            <i class="material-icons material-icons-16">share</i>
                        </button>
                    </div>
                </div>
                <div class="mdl-cell mdl-cell--12-col mdl-cell--order-2 mdl-cell--order-3-phone">
                    <div class="mdl-card__supporting-text padding-top-zero padding-bottom-zero">                    
                        <p class="font-16 margin-bottom-8"> ${ _strings.pratilipi_listing_date }:&nbsp;
                            <!--ko text:  convertDate( pratilipi.listingDateMillis() ) -->
                            <!--/ko-->
                        </p>
                        <p class="font-16 margin-bottom-8"> ${ _strings.pratilipi_type }:&nbsp;
                            <!--ko text: getPratilipiTypeVernacular( pratilipi.type() ) -->
                            <!--/ko-->
                        </p>
                    </div>
                </div>
    
            </div>
            
            
            <!-- ko if: pratilipi.summary -->
                <div class="mdl-cell mdl-cell--12-col padding-zero">
                    <hr class="margin-zero">
                </div>
                <h3 class="mdl-cell mdl-cell--12-col mdl-typography--headline">${ _strings.pratilipi_summary }</h3>
                <div class="mdl-cell mdl-cell--12-col mdl-card__supporting-text padding-zero ">
                    <pratilipi-see-more params="{ originalText: pratilipi.summary(), uniqueName: 'summary' }"></pratilipi-see-more>
                </div>
            <!-- /ko -->
    
            <div class="mdl-cell mdl-cell--12-col padding-zero">
                <hr class="margin-zero">
            </div>
            <h3 class="mdl-cell mdl-cell--12-col mdl-typography--headline">${ _strings.author_about }</h3>
            <div data-bind="visible: ! authorLoaded()" 
                style="margin: 25px auto;"  
                class="mdl-spinner mdl-spinner--single-color mdl-js-spinner is-active">
            </div>
            <div data-bind="visible: authorLoaded()">
                <div class="mdl-cell mdl-cell--12-col" style="display: flex; align-items: center; justify-content: space-between;">
                    <span style="display: flex; align-items: center;">
                        <img data-bind="attr: { src: getImageUrl( author.profileImageUrl(), 48 ) }" class="mdl-list__item-avatar">
                        <a class="black-color" style="margin: 10px; font-weight: 700;" data-bind="attr: { href: author.pageUrl() }, text: author.name()"></a>
                    </span>
                    <button data-bind="{ click: followAuthor, 
                                        text: userAuthor.following() ? '${ _strings.author_unfollow }': '${ _strings.author_follow }',
                                        visible: canFollowAuthor,
                                        disable: userAuthorRequestOnFlight }" 
                            class="mdl-button mdl-js-button mdl-button--primary mdl-layout--large-screen-only">
                    </button>
                     <button data-bind="{ click: followAuthor,
                                        visible: canFollowAuthor,
                                        disable: userAuthorRequestOnFlight }" 
                                class="mdl-button mdl-js-button mdl-button--icon mdl-button--colored mdl-layout--small-screen-only">
                        <i class="material-icons" data-bind="text: ( userAuthor.following() ? 'done' : 'person_add' )"></i>
                    </button>
                </div>
                <div class="mdl-cell mdl-cell--12-col mdl-card__supporting-text padding-zero " data-bind="if: author.summary() != null">
                    <pratilipi-see-more params="{ originalText: author.summary(), uniqueName: 'author-about' }"></pratilipi-see-more>
                </div>
            </div>
       </div>
    </div>
</div>

<div class="modal common-modal fade" id="pratilipi-share-dialog" tabindex="-1" role="dialog" aria-labelledby="shareLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button class="mdl-button mdl-js-button mdl-button--icon close" class="close" data-dismiss="modal" aria-label="Close">
                <i class="material-icons">close</i>
                </button>
                <h4 class="modal-title" id="shareLabel">${ _strings.share }</h4>
            </div>
            <div class="modal-body">
                <ul class="demo-list-icon mdl-list">
                    <li data-bind="click: shareOnSocialMedia" class="mdl-list__item clickable-element" data-share-platform="FACEBOOK">
                        <span class="mdl-list__item-primary-content">
                            <div class="sprites-icon mdl-list__item-icon facebook-icon"></div>
                            ${ _strings.facebook }
                        </span>
                    </li>
                    <li data-bind="click: shareOnSocialMedia" class="mdl-list__item clickable-element" data-share-platform="TWITTER">
                        <span class="mdl-list__item-primary-content">
                            <div class="sprites-icon mdl-list__item-icon twitter-icon"></div>
                            ${ _strings.twitter }
                        </span>
                    </li>
                    <li data-bind="click: shareOnSocialMedia" class="mdl-list__item clickable-element" data-share-platform="GPLUS">
                        <span class="mdl-list__item-primary-content">
                            <div class="sprites-icon mdl-list__item-icon google-plus-icon"></div>
                            ${ _strings.google_plus }
                        </span>
                    </li>
                    <li data-bind="click: shareOnSocialMedia" class="mdl-list__item clickable-element mdl-layout--small-screen-only" data-share-platform="WHATSAPP">
                        <span class="mdl-list__item-primary-content">
                            <div class="sprites-icon mdl-list__item-icon whatsapp-icon"></div>
                            ${ _strings.whatsapp }
                        </span>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>  
