<div class="mdl-card mdl-card-border mdl-cell mdl-cell--8-col-tablet mdl-cell--9-col mobile-card pratilipi-review-list">
	<div class="mdl-grid" style="margin: 0;">

		<h3 class="mdl-cell mdl-cell--12-col mdl-typography--headline">${ _strings.review_heading }</h3>

		<#--  if user is logged in or has access to review, then show add review section -->
		<div class="mdl-cell mdl-cell--12-col mdl-card__supporting-text padding-zero " data-bind="visible: hasAccessToReview()">
			<div class="mdl-grid padding-zero mdl-grid--no-spacing">
				<div class="mdl-cell--6-col mdl-cell--4-col-tablet padding-zero">
					<!-- ko foreach: ko.utils.range( 1, selectedReviewRating ) -->
						<i class="material-icons material-icons-36 clickable-element" data-bind="click: $parent.openReviewModalWithRating.bind($data, $data)">star</i>
					<!-- /ko -->
					<!-- ko foreach: ko.utils.range( 1, emptyReviewRating ) -->
						<i class="material-icons material-icons-36 clickable-element" data-bind="click: $parent.openReviewModalWithRating.bind($data, $data + $parent.selectedReviewRating() )">star_border</i>
					<!-- /ko -->
				</div>
				<div class="mdl-cell--6-col mdl-cell--4-col-tablet padding-zero">
					<button data-bind="click: openReviewModal.bind( $data )" class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored mdl-js-ripple-effect pull-right write-review-button">${ _strings.review_write_a_review }</button>
				</div>
			</div>
		</div>

		<#--  while waiting for ajax request for reviews -->
		<div data-bind="visible: ! isReviewsLoaded()" 
			style="margin: 25px auto;display: block;"  
			class="mdl-spinner mdl-spinner--single-color mdl-js-spinner is-active">
		</div>  

		<#--  when reviews have loaded and are equal 0 in number and user has access to review -->
		<!-- ko if: isReviewsLoaded() && reviewList().length == 0 && hasAccessToReview() -->
			<div class="mdl-cell mdl-cell--12-col mdl-card__supporting-text padding-zero material-subtitle-2">
				${ _strings.rating_be_first_one }
			</div>
		<!-- /ko -->

		<#--  when reviews have loaded and are equal 0 in number and user doesnt have access to review -->
		<!-- ko if: isReviewsLoaded() && reviewList().length == 0 && !hasAccessToReview() -->
			<div class="mdl-cell mdl-cell--12-col mdl-card__supporting-text padding-zero review-not-present">
				${ _strings.pratilipi_no_reviews }
			</div> 
		<!-- /ko -->

		<#--  when reviews have loaded and are greater than 0 -->			
		<div class="mdl-cell mdl-cell--12-col mdl-card__supporting-text padding-zero " data-bind="visible: reviewList().length > 0">
			<ul class="demo-list-three mdl-list" data-bind="foreach: reviewList">
				<pratilipi-review params="{ value: $data, deleteReview: $parent.deleteReview, pratilipiId: $parent.pratilipiId }"></pratilipi-review>							   
			</ul>
			<div data-bind="visible: areMoreReviewsLoading()" 
				style="margin: 25px auto;"  
				class="mdl-spinner mdl-spinner--single-color mdl-js-spinner is-active display-block-unimportant">
			</div>
			<li class="show-more" data-bind="visible: areMoreReviews() && !areMoreReviewsLoading()">
				<div>
					<center>
						<button data-bind="click: loadMoreReviews" class="mdl-button mdl-js-button mdl-button--accent mdl-js-ripple-effect">${ _strings.show_more }</button>
					</center>
				</div>
			</li>
		</div>
	</div>
</div>

<#-- Modal -->
<div class="modal common-modal fade" id="pratilipi-review-dialog" tabindex="-1" role="dialog" aria-labelledby="reviewLabel">
  <div class="modal-dialog" role="document">
	<div class="modal-content">
		<div class="modal-header">
			<button class="mdl-button mdl-js-button mdl-button--icon close" class="close" data-dismiss="modal" aria-label="Close">
	  			<i class="material-icons">close</i>
			</button>
		  	<h6 class="modal-title" id="reviewLabel">${ _strings.rate_and_review }</h6>
		</div>
		<div class="modal-body">
			<!-- ko foreach: ko.utils.range( 1, selectedReviewRating ) -->
				<i class="material-icons material-icons-36 clickable-element" data-bind="click: $parent.changeReviewRating.bind($data, $data)">star</i>
			<!-- /ko -->
			<!-- ko foreach: ko.utils.range( 1, emptyReviewRating ) -->
				<i class="material-icons material-icons-36 clickable-element" data-bind="click: $parent.changeReviewRating.bind($data, $data + $parent.selectedReviewRating() )">star_border</i>
			<!-- /ko -->
			<form action="#">
				<div class="mdl-textfield mdl-js-textfield">
					<textarea make-transliterable data-bind="textInput: newReviewContent" class="mdl-textfield__input" type="text" rows= "3" id="review" ></textarea>
					<label class="mdl-textfield__label" for="review" data-bind="text: newReviewContent().length ? '' : '${ _strings.review_write_a_review }'"></label>
				</div>
			</form>
		</div>
		<div class="modal-footer">
			<button data-bind="click: restoreRating" class="mdl-button mdl-js-button mdl-js-ripple-effect close"  data-dismiss="modal">${ _strings.cancel }</button>
			<button data-bind="click: postNewReview, disable: isSaveDisabled" class="mdl-button mdl-js-button mdl-button--colored mdl-js-ripple-effect mdl-button--raised">${ _strings.review_submit_review }</button>
		</div>
	</div>
  </div>
</div> 