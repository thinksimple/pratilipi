<!DOCTYPE html>
<html lang="${ lang }">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="A platform to discover, read and share your favorite stories, poems and books in a language, device and format of your choice.">  
  <title>Pratilipi Summary Page</title>
  <script src="https://d3cwrmdwk8nw1j.cloudfront.net/third-party/compress/jquery.knockout.boostrap.js" type="text/javascript"></script>  
</head>
<body>
	<div>
	    <h1>Summary Knockout PWA</h1>
	</div>
	
	<div data-bind="foreach: {data: sectionList, as: 'section'}, visible: sectionList().length > 0">
	    <h3 class="section-title"><a data-bind="text: title, attr: {href:listPageUrl, target:'_blank'}"></a></h3>
	    <div class="row" data-bind="foreach: {data: pratilipiList, as: 'pratilipi'}">
	        <div class="col-xs-12 col-sm-6 col-md-6 col-lg-4 pratilipi-card">
	            <div class="image-holder">
	                <a data-bind="attr: {href:pageUrl}">
	                    <img width="100" height="150" data-bind="attr: {src: coverImageUrl+'&width=150'}" />
	                </a>
	            </div>
	            <div class="info-holder">
	                <h4 class="pratilipi-title"><a data-bind="attr: {href:pageUrl,title:title}, text: title"></a></h4>
	                <h5 class="author-name"><a data-bind="attr: {href:author.pageUrl,title:author.name,target:'_blank'}, text: author.name"></a></h4>
	                <div class="meta-info">
	                    <div data-bind="visible: averageRating > 0"><span data-bind="text: averageRating.toFixed(1)"></span>&nbsp;Stars</div>
	                </div>
	                <a data-bind="attr: {href:readPageUrl}" class="read-button">Read</a>
	            </div>
	        </div>
	    </div>
	    <div style="min-height: 20px;">&nbsp;</div>
	</div>

  <script type="application/javascript">
	$(function(){
	  var ViewModel = {
	      sectionList: ko.observableArray([]),
	      pushToSectionList: function(sectionList){for(var i=0;i<sectionList.length;i++)this.sectionList.push(sectionList[i]);}
	  };
	  
	  ko.applyBindings( ViewModel );
	  $( '.carousel' ).carousel();
	  $.ajax({
	    type: 'get',
	    url: '/api/init?_apiVer=2&language=HINDI',
	    success: function( response ) {
	    	var res = jQuery.parseJSON( response );
			ViewModel.pushToSectionList(res["sections"]);
	    },
	    error: function( response ) {
	        console.log( response );
	    	console.log( typeof(response) );
	    }
	  });
	});
  </script>

</body>
</html>
